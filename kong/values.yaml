image:
  repository: ghcr.io/ftuajii/bookinfo/kong-gateway
  tag: "3.10"

secretVolumes:
  - kong-cluster-cert

admin:
  enabled: false

env:
  role: data_plane
  database: "off"
  cluster_mtls: pki
  cluster_control_plane: 95d2a389d1.us.cp.konghq.com:443
  cluster_dp_labels: "type:docker-kubernetesOS"
  cluster_server_name: 95d2a389d1.us.cp.konghq.com
  cluster_telemetry_endpoint: 95d2a389d1.us.tp.konghq.com:443
  cluster_telemetry_server_name: 95d2a389d1.us.tp.konghq.com
  cluster_cert: /etc/secrets/kong-cluster-cert/tls.crt
  cluster_cert_key: /etc/secrets/kong-cluster-cert/tls.key
  lua_ssl_trusted_certificate: system
  konnect_mode: "on"
  vitals: "off"
  nginx_worker_processes: "1"
  upstream_keepalive_max_requests: "100000"
  nginx_http_keepalive_requests: "100000"
  proxy_access_log: "off"
  dns_stale_ttl: "3600"
  router_flavor: expressions

ingressController:
  enabled: false
  installCRDs: false

# Data Planeモードでは起動に時間がかかるため、probeの待ち時間を調整
readinessProbe:
  httpGet:
    path: "/status/ready"
    port: status
    scheme: HTTP
  initialDelaySeconds: 30
  timeoutSeconds: 5
  periodSeconds: 10
  successThreshold: 1
  failureThreshold: 3

livenessProbe:
  httpGet:
    path: "/status"
    port: status
    scheme: HTTP
  initialDelaySeconds: 30
  timeoutSeconds: 5
  periodSeconds: 10
  successThreshold: 1
  failureThreshold: 3

resources:
  requests:
    cpu: 100m
    memory: "512Mi"
  limits:
    cpu: 1
    memory: "1Gi"

# Horizontal Pod Autoscaler (HPA)
# CPU使用率に基づいてPod数を自動調整
autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 5
  targetCPUUtilizationPercentage: 70

manager:
  enabled: false
